<form method="GET" 
<% if(isTest) { if(isLast) { %>
        action="/learn/test/results/<%= scheduledTestID %>/<%= userID %>"
    <% } else { %>
        action="/learn/test/<%= scheduledTestID %>/<%= exerciseID %>"
    <% } %>
    
<% } else { %>
    action="/learn/exercise/<%= lessonID %>/<%= exercisePos %>"
<% } %>
>

    <div style="display: flex; justify-content: center; align-items: center; flex-direction: row;">
        <!-- exercise's text -->
        <div>
            <div style="font-weight: bold;">
                <p><%= exercise.exercise_text %></p>
                <p>Eredmény: <%= correctAnswers %> / <%= points %> </p>
                <button id="displayButton">Mutasd meg a válaszokat!</button>
                <p id="result" style="display: none;"><%= points %></p>
                <p id="direction" style="display: none;"><%= exercise.exercise_direction %></p>
            </div>
            <div>
            <% if(exercise.image_object){ %>
            <div style="text-align: center;">
            <img src="data:image/jpeg;base64, <%= exercise.image_object.toString('base64') %>" alt="<%= exercise.image_text %>">
            </div>
            <% } %>
        </div>
        <!-- answers -->
        <div id="container" style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
            <div style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
                <div>
                    <p style="font-weight: bold;">A helyes megoldás:</p>
                </div>
                <div id="correct" style="display: flex; flex-direction: row; margin-bottom: 20px;">
                    <% for(let i=0; i<answers.length/2; i++){ %>
                    <div style="border: solid gray 1px; background-color: white; width: 160px; height: 130px;">
                        <div>
                        <img src="data:image/jpeg;base64, <%= answers[i].image_object.toString('base64') %>" alt="<%= answers[i].image_text %>" style="width: 160px; height: 130px;">
                        </div>
                    </div>
                    <% } %>
                </div>
            </div>
            <div style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
                <div>
                    <p style="font-weight: bold;">A megoldásod:</p>
                </div>
                <div id="answer" style="display: flex; flex-direction: row;">
                    <% for(let i=answers.length/2; i<answers.length; i++){ %>
                    <div style="border: solid gray 1px; background-color: white; width: 160px; height: 130px;">
                        <div>
                            <img src="data:image/jpeg;base64, <%= answers[i].image_object.toString('base64') %>" alt="<%= answers[i].image_text %>" style="width: 160px; height: 130px;">
                        </div>
                    </div>
                    <% } %>
                </div>
            </div>
        </div>

        <div>
            <input type="submit" value="Next" id="nextButton">
        </div>
    </div>
</form>

<div class="soundContainer" style="display: none;">
    <audio controls="" id="correctSound">
    <source src="/learn/sound/correct.wav" type="audio/wav">
    </audio>

    <audio controls="" id="wrongSound">
    <source src="/learn/sound/wrong.mp3" type="audio/mpeg">
    </audio>     
</div>

<script>
    const correct = document.getElementById("correctSound");
    const wrong = document.getElementById("wrongSound");

    const result=document.getElementById("result");
    const answerDiv=document.getElementById("answer");
    const correctDiv=document.getElementById("correct");
    const direction=document.getElementById("direction");
    const displayButton=document.getElementById("displayButton");
    let delay = 1000;

    function colour(){
        setTimeout(()=>{
            if(result.textContent == "1"){
            answerDiv.style.border="solid 2px green";
            console.log(correct);
            correct.play();
        }
        else{
            answerDiv.style.border="solid 2px red";
            wrong.play();
        }
        }, delay);
    }
    displayButton.addEventListener('click', function(e){
        e.preventDefault();
        e.target.setAttribute("disabled", "true");
        colour();
    });

    const container=document.getElementById("container");
    if(direction.textContent == "vertical"){
        answerDiv.style.flexDirection = "column";
        correctDiv.style.flexDirection = "column";
        correctDiv.style.marginBottom = "0px";
        answerDiv.style.marginLeft = "70px";
        container.style.flexDirection="";
    }

</script>